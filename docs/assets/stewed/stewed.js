var Dropdown=function(t,e){"use strict";this.dropdown=t,this.id=document.getElementById(e),this.show=function(){if(this.id.classList.contains("dropdown--visible"))this.id.className+=" dropdown--animatable",this.id.classList.remove("dropdown--visible");else{var t=document.getElementsByClassName("dropdown--visible");t.length>0&&t[0].classList.remove("dropdown--visible"),this.id.className+=" dropdown--visible"}},this.id.addEventListener("transitionend",function(){this.classList.contains("dropdown--animatable")&&this.classList.remove("dropdown--animatable")})};!function(){"use strict";for(var t=document.querySelectorAll("[stewed-dropdown]"),e=0;e<t.length;e++){var s=t[e];s.addEventListener("click",function(){var t=this.getAttribute("stewed-dropdown"),e=new Dropdown(this,t);this.classList.contains("disabled")||e.show()})}}();var Form=function(){"use strict";const t=document.querySelectorAll('[stewed-validate="true"]');for(var e=document.getElementsByClassName("textfield__input"),s=0;s<e.length;s++)if(!e[s].disabled){var i=e[s];i.parentNode.className="textfield",i.addEventListener("input",function(){if(t.length){const e=""==this.min?"tel"==this.type?9:2:this.min,s=""==this.max?"tel"==this.type?13:Number.MAX_SAFE_INTEGER:this.max,i=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;"select-one"==this.type?""!=this.value?this.parentNode.className="textfield textfield--valid":this.parentNode.className="textfield textfield--invalid":"textarea"==this.type?this.value.length>1?this.parentNode.className="textfield textfield--valid":0==this.value.length?this.parentNode.className="textfield":this.parentNode.className="textfield textfield--invalid":this.value.length>=e&&this.value.length<=s?"email"==this.type?i.test(this.value)?this.parentNode.className="textfield textfield--valid":this.parentNode.className="textfield textfield--invalid":this.parentNode.className="textfield textfield--valid":0==this.value.length?this.parentNode.className="textfield":this.parentNode.className="textfield textfield--invalid"}else this.value.length>1?this.parentNode.className="textfield textfield--filled":this.parentNode.className="textfield"})}};!function(){"use strict";new Form}();var Modal=function(t){"use strict";var e=this;if(this.modal=document.getElementById(t),this.isOpen=!1,null!==this.modal){for(var s=this.modal.getElementsByClassName("modal-close"),i=0;i<s.length;i++){var a=s[i];a.addEventListener("click",function(){e.hide()})}this.modal.addEventListener("transitionend",function(){this.classList.contains("modal--animatable")&&this.classList.remove("modal--animatable")}),document.addEventListener("keyup",function(t){27===t.keyCode&&e.isOpen&&e.hide()})}this.show=function(){null!==this.modal&&(this.modal.classList.add("modal--visible"),this.isOpen=!0)},this.hide=function(){null!==this.modal&&(this.modal.classList.remove("modal--visible"),this.modal.classList.add("modal--animatable"),this.isOpen=!1)}};!function(){"use strict";for(var t=[],e=document.querySelectorAll("[stewed-modal]"),s=0;s<e.length;s++){var i=e[s],a=i.getAttribute("stewed-modal");t[a]=new Modal(a),i.addEventListener("click",function(){var e=this.getAttribute("stewed-modal"),s=t[e];s.isOpen?s.hide():s.show()})}}();var snackbar=function(t){"use strict";var e=this;if(this.snackbar=document.getElementById(t),this.isOpen=!1,null!==this.snackbar){for(var s=this.snackbar.getElementsByClassName("snackbar-close"),i=0;i<s.length;i++){var a=s[i];a.addEventListener("click",function(){e.hide()})}this.snackbar.addEventListener("transitionend",function(){this.classList.contains("snackbar--animatable")&&this.classList.remove("snackbar--animatable")}),document.addEventListener("keyup",function(t){27===t.keyCode&&e.isOpen&&e.hide()})}this.show=function(){null!==this.snackbar&&(this.snackbar.classList.add("snackbar--visible"),this.isOpen=!0)},this.hide=function(){null!==this.snackbar&&(this.snackbar.classList.remove("snackbar--visible"),this.snackbar.classList.add("snackbar--animatable"),this.isOpen=!1)}};!function(){"use strict";for(var t=[],e=document.querySelectorAll("[stewed-snackbar]"),s=0;s<e.length;s++){var i=e[s],a=i.getAttribute("stewed-snackbar");t[a]=new snackbar(a),i.addEventListener("click",function(){var e=this.getAttribute("stewed-snackbar"),s=t[e];s.isOpen?s.hide():s.show()})}}();var Tabs=function(t,e){"use strict";this.tab=t,this.id=document.getElementById(e),this.hide=function(){for(var t=this.tab.parentNode.children,e=this.id.parentNode.children,s=0;s<t.length;s++)t[s].classList.remove("tabs__item--active");for(var i=0;i<e.length;i++)e[i].classList.remove("tab-section--active")},this.show=function(){this.tab.classList.add("tabs__item--active"),this.id.classList.add("tab-section--active")}};!function(){"use strict";var t=document.getElementsByClassName("tabs__item");Array.from(t);for(var e=0;e<t.length;e++){var s=t[e];s.addEventListener("click",function(){var t=this.getAttribute("stewed-tab-id"),e=new Tabs(this,t);"false"!==t&&(this.classList.contains("disabled")||(e.hide(),e.show()))})}window.addEventListener("keypress",function(e){switch(e.keyCode){case KEY_UP:case KEY_LEFT:index--;break;case KEY_RIGHT:case KEY_DOWN:index++}index<0?index=0:index>=t.length&&(index=t.length-1),console.log(index)})}();var toast=function(){"use strict"};!function(){"use strict";toast()}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRyb3Bkb3duL2Ryb3Bkb3duLmpzIiwiZm9ybS9mb3JtLmpzIiwibW9kYWwvbW9kYWwuanMiLCJzbmFja2Jhci9zbmFja2Jhci5qcyIsInRhYnMvdGFicy5qcyIsInRvYXN0L3RvYXN0LmpzIl0sIm5hbWVzIjpbIkRyb3Bkb3duIiwic2VsZWN0ZWQiLCJpZCIsInRoaXMiLCJkcm9wZG93biIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzaG93IiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJjbGFzc05hbWUiLCJyZW1vdmUiLCJlbGVtZW50cyIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJsZW5ndGgiLCJhZGRFdmVudExpc3RlbmVyIiwiZWxlbXMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaSIsIm15RHJvcGRvd24iLCJnZXRBdHRyaWJ1dGUiLCJGb3JtIiwiVkFMSURBVEUiLCJpbnB1dHMiLCJkaXNhYmxlZCIsImlucHV0IiwicGFyZW50Tm9kZSIsIk1JTiIsIm1pbiIsInR5cGUiLCJNQVgiLCJtYXgiLCJOdW1iZXIiLCJNQVhfU0FGRV9JTlRFR0VSIiwiRU1BSUwiLCJ2YWx1ZSIsInRlc3QiLCJNb2RhbCIsIm1vZGFsSWQiLCJfc2VsZiIsIm1vZGFsIiwiaXNPcGVuIiwiY2xvc2VCdXR0b25zIiwiYnRuX2Nsb3NlIiwiaGlkZSIsImUiLCJrZXlDb2RlIiwiYWRkIiwibWVtb3J5X21vZGFscyIsImVsZW0iLCJjdXJyZW50X21vZGFsIiwic25hY2tiYXIiLCJzbmFja2JhcklkIiwibWVtb3J5X3NuYWNrYmFycyIsImN1cnJlbnRfc25hY2tiYXIiLCJUYWJzIiwidGFiIiwicGFyZW50VGFicyIsImNoaWxkcmVuIiwic2VjdGlvbnNUYWJzIiwiaiIsInRhYnMiLCJBcnJheSIsImZyb20iLCJteVRhYiIsIndpbmRvdyIsIktFWV9VUCIsIktFWV9MRUZUIiwiaW5kZXgiLCJLRVlfUklHSFQiLCJLRVlfRE9XTiIsImNvbnNvbGUiLCJsb2ciLCJ0b2FzdCJd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LFNBQ0FDLEVBQUF4RCxLQUFBRCxHQUFBd0IsV0FBQWdDLFNBRUF4QyxFQUFBLEVBQUFBLEVBQUF1QyxFQUFBM0MsT0FBQUksSUFDQXVDLEVBQUF2QyxHQUFBVixVQUFBRyxPQUFBLHFCQUdBLEtBQUEsR0FBQWlELEdBQUEsRUFBQUEsRUFBQUQsRUFBQTdDLE9BQUE4QyxJQUNBRCxFQUFBQyxHQUFBcEQsVUFBQUcsT0FBQSx3QkFJQVIsS0FBQUksS0FBQSxXQUNBSixLQUFBcUQsSUFBQWhELFVBQUF1QyxJQUFBLHNCQUNBNUMsS0FBQUQsR0FBQU0sVUFBQXVDLElBQUEsMEJBTUEsV0FDQSxZQUdBLElBQUFjLEdBQUF4RCxTQUFBUSx1QkFBQSxhQUdBaUQsT0FBQUMsS0FBQUYsRUFFQSxLQUFBLEdBQUEzQyxHQUFBLEVBQUFBLEVBQUEyQyxFQUFBL0MsT0FBQUksSUFBQSxDQUNBLEdBQUE4QyxHQUFBSCxFQUFBM0MsRUFHQThDLEdBQUFqRCxpQkFBQSxRQUFBLFdBR0EsR0FBQWIsR0FBQUMsS0FBQWlCLGFBQUEsaUJBQ0FvQyxFQUFBLEdBQUFELE1BQUFwRCxLQUFBRCxFQUVBLFdBQUFBLElBQ0FDLEtBQUFLLFVBQUFDLFNBQUEsY0FDQStDLEVBQUFaLE9BQ0FZLEVBQUFqRCxXQVNBMEQsT0FBQWxELGlCQUFBLFdBQUEsU0FBQThCLEdBR0EsT0FBQUEsRUFBQUMsU0FDQSxJQUFBb0IsUUFDQSxJQUFBQyxVQUNBQyxPQUNBLE1BRUEsS0FBQUMsV0FDQSxJQUFBQyxVQUNBRixRQU1BQSxNQUFBLEVBQ0FBLE1BQUEsRUFDQUEsT0FBQVAsRUFBQS9DLFNBQ0FzRCxNQUFBUCxFQUFBL0MsT0FBQSxHQUdBeUQsUUFBQUMsSUFBQUosV0N0RkEsSUFBQUssT0FBQSxXQUNBLGVBTUEsV0FDQSxZQUNBQSIsImZpbGUiOiJzdGV3ZWQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgICAgdmFyIERyb3Bkb3duID0gZnVuY3Rpb24oc2VsZWN0ZWQsIGlkKSB7XG4gICAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgICB0aGlzLmRyb3Bkb3duID0gc2VsZWN0ZWQ7XG4gICAgICAgIHRoaXMuaWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG5cblxuICAgICAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICBpZiAoIXRoaXMuaWQuY2xhc3NMaXN0LmNvbnRhaW5zKCdkcm9wZG93bi0tdmlzaWJsZScpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZHJvcGRvd24tLXZpc2libGUnKTtcblxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnRzWzBdLmNsYXNzTGlzdC5yZW1vdmUoXCJkcm9wZG93bi0tdmlzaWJsZVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5pZC5jbGFzc05hbWUgKz0gXCIgZHJvcGRvd24tLXZpc2libGVcIjtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlkLmNsYXNzTmFtZSArPSBcIiBkcm9wZG93bi0tYW5pbWF0YWJsZVwiO1xuICAgICAgICAgICAgICAgIHRoaXMuaWQuY2xhc3NMaXN0LnJlbW92ZShcImRyb3Bkb3duLS12aXNpYmxlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5pZC5hZGRFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgaWYgKHRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKCdkcm9wZG93bi0tYW5pbWF0YWJsZScpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGFzc0xpc3QucmVtb3ZlKCdkcm9wZG93bi0tYW5pbWF0YWJsZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgIH07XG5cblxuICAgICEgZnVuY3Rpb24oKXtcbiAgICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICAgIC8qIGdldCBkcm9wZG93biBpdGVtICovXG4gICAgICAgIHZhciBlbGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tzdGV3ZWQtZHJvcGRvd25dJyk7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtcy5sZW5ndGg7IGkrKykge1xuXG4gICAgICAgICAgICB2YXIgbXlEcm9wZG93biA9IGVsZW1zW2ldO1xuXG4gICAgICAgICAgICAvKiBvbiBjbGljayBpbiB0YWIgKi9cbiAgICAgICAgICAgIG15RHJvcGRvd24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAndXNlIHN0cmljdCc7XG5cbiAgICAgICAgICAgICAgICB2YXIgaWQgPSB0aGlzLmdldEF0dHJpYnV0ZSgnc3Rld2VkLWRyb3Bkb3duJylcbiAgICAgICAgICAgICAgICB2YXIgZHJvcGRvd24gPSBuZXcgRHJvcGRvd24odGhpcywgaWQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCAhdGhpcy5jbGFzc0xpc3QuY29udGFpbnMoJ2Rpc2FibGVkJykgKSB7XG4gICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNob3coKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pOyAgICAgICAgXG5cbiAgICAgICAgfVxuXG4gICAgfSgpO1xuXG5cbiIsInZhciBGb3JtID0gZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGNvbnN0IFZBTElEQVRFID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW3N0ZXdlZC12YWxpZGF0ZT1cInRydWVcIl0nKTtcbiAgICB2YXIgaW5wdXRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndGV4dGZpZWxkX19pbnB1dCcpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnB1dHMubGVuZ3RoOyBpKyspIHtcblxuICAgICAgICBpZiAoISBpbnB1dHNbaV0uZGlzYWJsZWQpIHtcbiAgICAgICAgICAgIHZhciBpbnB1dCA9IGlucHV0c1tpXTtcbiAgICAgICAgICAgIGlucHV0LnBhcmVudE5vZGUuY2xhc3NOYW1lID0gJ3RleHRmaWVsZCc7XG5cbiAgICAgICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICAgICAgICAgICAgaWYgKFZBTElEQVRFLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBNSU4gPSAodGhpcy5taW4gPT0gJycpID8gKCh0aGlzLnR5cGUgPT0gJ3RlbCcpID8gOSA6IDIgKSA6IHRoaXMubWluLFxuICAgICAgICAgICAgICAgICAgICBNQVggPSAodGhpcy5tYXggPT0gJycpID8gKCh0aGlzLnR5cGUgPT0gJ3RlbCcpID8gMTMgOiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiApIDogdGhpcy5tYXgsXG4gICAgICAgICAgICAgICAgICAgIEVNQUlMID0gL14oW1xcdy1dKyg/OlxcLltcXHctXSspKilAKCg/OltcXHctXStcXC4pKlxcd1tcXHctXXswLDY2fSlcXC4oW2Etel17Miw2fSg/OlxcLlthLXpdezJ9KT8pJC9pO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnR5cGUgPT0gJ3NlbGVjdC1vbmUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy52YWx1ZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLmNsYXNzTmFtZSA9ICd0ZXh0ZmllbGQgdGV4dGZpZWxkLS12YWxpZCc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5jbGFzc05hbWUgPSAndGV4dGZpZWxkIHRleHRmaWVsZC0taW52YWxpZCc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy50eXBlID09ICd0ZXh0YXJlYScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudE5vZGUuY2xhc3NOYW1lID0gJ3RleHRmaWVsZCB0ZXh0ZmllbGQtLXZhbGlkJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy52YWx1ZS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5jbGFzc05hbWUgPSAndGV4dGZpZWxkJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLmNsYXNzTmFtZSA9ICd0ZXh0ZmllbGQgdGV4dGZpZWxkLS1pbnZhbGlkJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggKHRoaXMudmFsdWUubGVuZ3RoID49IE1JTiApICYmICh0aGlzLnZhbHVlLmxlbmd0aCA8PSBNQVgpICkgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy50eXBlID09ICdlbWFpbCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEVNQUlMLnRlc3QodGhpcy52YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5jbGFzc05hbWUgPSAndGV4dGZpZWxkIHRleHRmaWVsZC0tdmFsaWQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLmNsYXNzTmFtZSA9ICd0ZXh0ZmllbGQgdGV4dGZpZWxkLS1pbnZhbGlkJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5jbGFzc05hbWUgPSAndGV4dGZpZWxkIHRleHRmaWVsZC0tdmFsaWQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy52YWx1ZS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5jbGFzc05hbWUgPSAndGV4dGZpZWxkJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLmNsYXNzTmFtZSA9ICd0ZXh0ZmllbGQgdGV4dGZpZWxkLS1pbnZhbGlkJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5jbGFzc05hbWUgPSAndGV4dGZpZWxkIHRleHRmaWVsZC0tZmlsbGVkJztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5jbGFzc05hbWUgPSAndGV4dGZpZWxkJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuIWZ1bmN0aW9uKCl7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIG5ldyBGb3JtKCk7XG59KCk7IiwidmFyIE1vZGFsID0gZnVuY3Rpb24obW9kYWxJZCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBfc2VsZiA9IHRoaXM7XG4gICAgdmFyIG51bSA9IDE7XG5cbiAgICB0aGlzLm1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobW9kYWxJZCk7XG4gICAgdGhpcy5pc09wZW4gPSBmYWxzZTtcbiAgICBcbiAgICAvKiBDb25zdHJ1Y3RvciAqL1xuICAgIGlmKHRoaXMubW9kYWwgIT09IG51bGwpIHtcblxuICAgICAgICB2YXIgY2xvc2VCdXR0b25zID0gdGhpcy5tb2RhbC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdtb2RhbC1jbG9zZScpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNsb3NlQnV0dG9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGJ0bl9jbG9zZSA9IGNsb3NlQnV0dG9uc1tpXTtcbiAgICAgICAgICAgIGJ0bl9jbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgX3NlbGYuaGlkZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIiwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGlmKHRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbC0tYW5pbWF0YWJsZScpKXtcbiAgICAgICAgICAgICAgICB0aGlzLmNsYXNzTGlzdC5yZW1vdmUoJ21vZGFsLS1hbmltYXRhYmxlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvL2FkZCBrZXkgY2xvc2UgZXZlbnRcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAndXNlIHN0cmljdCdcblxuICAgICAgICAgICAgaWYoZS5rZXlDb2RlID09PSAyNyAmJiBfc2VsZi5pc09wZW4pIHtcbiAgICAgICAgICAgICAgICBfc2VsZi5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qIFNob3cgQ3VycmVudCBNb2RhbCAqL1xuICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYodGhpcy5tb2RhbCAhPT0gbnVsbCl7XG4gICAgICAgICAgICB0aGlzLm1vZGFsLmNsYXNzTGlzdC5hZGQoJ21vZGFsLS12aXNpYmxlJyk7XG4gICAgICAgICAgICB0aGlzLmlzT3BlbiA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLyogSGlkZSBDdXJyZW50IE1vZGFsICovXG4gICAgdGhpcy5oaWRlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgaWYodGhpcy5tb2RhbCAhPT0gbnVsbCl7XG4gICAgICAgICAgICB0aGlzLm1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ21vZGFsLS12aXNpYmxlJyk7XG4gICAgICAgICAgICB0aGlzLm1vZGFsLmNsYXNzTGlzdC5hZGQoJ21vZGFsLS1hbmltYXRhYmxlJyk7XG4gICAgICAgICAgICB0aGlzLmlzT3BlbiA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbn07XG5cblxuISBmdW5jdGlvbigpe1xuICAgJ3VzZSBzdHJpY3QnO1xuXG4gICB2YXIgbWVtb3J5X21vZGFscyA9IFtdO1xuICAgdmFyIGVsZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW3N0ZXdlZC1tb2RhbF0nKTtcblxuICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtcy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBlbGVtID0gZWxlbXNbaV07XG4gICAgdmFyIG1vZGFsSWQgPSBlbGVtLmdldEF0dHJpYnV0ZSgnc3Rld2VkLW1vZGFsJyk7XG4gICAgbWVtb3J5X21vZGFsc1ttb2RhbElkXSA9IG5ldyBNb2RhbChtb2RhbElkKTtcblxuICAgIC8qIEVlbGVtZW50IGNsaWNrICovXG4gICAgZWxlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAndXNlIHN0cmljdCc7XG5cbiAgICAgICAgdmFyIGN1cnJlbnRfbW9kYWwgPSB0aGlzLmdldEF0dHJpYnV0ZSgnc3Rld2VkLW1vZGFsJyk7XG4gICAgICAgIHZhciBtb2RhbCA9IG1lbW9yeV9tb2RhbHNbY3VycmVudF9tb2RhbF07XG5cbiAgICAgICAgaWYgKG1vZGFsLmlzT3Blbikge1xuICAgICAgICAgICAgbW9kYWwuaGlkZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbW9kYWwuc2hvdygpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG59KCk7IiwidmFyIHNuYWNrYmFyID0gZnVuY3Rpb24oc25hY2tiYXJJZCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBfc2VsZiA9IHRoaXM7XG4gICAgdmFyIG51bSA9IDE7XG4gICAgXG4gICAgdGhpcy5zbmFja2JhciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNuYWNrYmFySWQpO1xuICAgIHRoaXMuaXNPcGVuID0gZmFsc2U7XG5cbiAgICAvKiBDb25zdHJ1Y3RvciAqL1xuICAgIGlmICh0aGlzLnNuYWNrYmFyICE9PSBudWxsKSB7XG5cbiAgICAgICAgdmFyIGNsb3NlQnV0dG9ucyA9IHRoaXMuc25hY2tiYXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc25hY2tiYXItY2xvc2UnKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjbG9zZUJ1dHRvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBidG5fY2xvc2UgPSBjbG9zZUJ1dHRvbnNbaV07XG4gICAgICAgICAgICBidG5fY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIF9zZWxmLmhpZGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNuYWNrYmFyLmFkZEV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5jbGFzc0xpc3QuY29udGFpbnMoJ3NuYWNrYmFyLS1hbmltYXRhYmxlJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsYXNzTGlzdC5yZW1vdmUoJ3NuYWNrYmFyLS1hbmltYXRhYmxlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8qIEFkZCBrZXkgY2xvc2UgZXZlbnQgKi9cbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAndXNlIHN0cmljdCc7XG4gICAgICAgICAgICBpZihlLmtleUNvZGUgPT09IDI3ICYmIF9zZWxmLmlzT3Blbil7XG4gICAgICAgICAgICAgICAgX3NlbGYuaGlkZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKiBTaG93IEN1cnJlbnQgc25hY2tiYXIgKi9cbiAgICB0aGlzLnNob3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKHRoaXMuc25hY2tiYXIgIT09IG51bGwpe1xuICAgICAgICAgICAgdGhpcy5zbmFja2Jhci5jbGFzc0xpc3QuYWRkKCdzbmFja2Jhci0tdmlzaWJsZScpO1xuICAgICAgICAgICAgdGhpcy5pc09wZW4gPSB0cnVlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8qIEhpZGUgQ3VycmVudCBzbmFja2JhciAqL1xuICAgIHRoaXMuaGlkZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGlmKHRoaXMuc25hY2tiYXIgIT09IG51bGwpe1xuICAgICAgICAgICAgdGhpcy5zbmFja2Jhci5jbGFzc0xpc3QucmVtb3ZlKCdzbmFja2Jhci0tdmlzaWJsZScpO1xuICAgICAgICAgICAgdGhpcy5zbmFja2Jhci5jbGFzc0xpc3QuYWRkKCdzbmFja2Jhci0tYW5pbWF0YWJsZScpO1xuICAgICAgICAgICAgdGhpcy5pc09wZW4gPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG5cbn07XG5cbi8vU0hPVyBzbmFja2JhclxuISBmdW5jdGlvbigpe1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBtZW1vcnlfc25hY2tiYXJzID0gW107XG4gICAgdmFyIGVsZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW3N0ZXdlZC1zbmFja2Jhcl0nKTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGVsZW0gPSBlbGVtc1tpXTtcbiAgICAgICAgdmFyIHNuYWNrYmFySWQgPSBlbGVtLmdldEF0dHJpYnV0ZSgnc3Rld2VkLXNuYWNrYmFyJyk7XG4gICAgICAgIG1lbW9yeV9zbmFja2JhcnNbc25hY2tiYXJJZF0gPSBuZXcgc25hY2tiYXIoc25hY2tiYXJJZCk7XG5cbiAgICAgICAgLyogRWxlbWVudCBjbGljayAqL1xuICAgICAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgICAgICAgdmFyIGN1cnJlbnRfc25hY2tiYXIgPSB0aGlzLmdldEF0dHJpYnV0ZSgnc3Rld2VkLXNuYWNrYmFyJyk7XG4gICAgICAgICAgICB2YXIgc25hY2tiYXIgPSBtZW1vcnlfc25hY2tiYXJzW2N1cnJlbnRfc25hY2tiYXJdO1xuXG4gICAgICAgICAgICBpZiAoc25hY2tiYXIuaXNPcGVuKSB7XG4gICAgICAgICAgICAgICAgc25hY2tiYXIuaGlkZSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzbmFja2Jhci5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn0oKTsiLCIgICAgdmFyIFRhYnMgPSBmdW5jdGlvbihzZWxlY3RlZCwgaWQpIHtcbiAgICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICAgIGNvbnN0IEtFWV9MRUZUID0gMzcsXG4gICAgICAgICAgICBLRVlfVVAgPSAzOCxcbiAgICAgICAgICAgIEtFWV9SSUdIVCA9IDM5LFxuICAgICAgICAgICAgS0VZX0RPV04gPSA0MDtcblxuICAgICAgICB0aGlzLnRhYiA9IHNlbGVjdGVkO1xuICAgICAgICB0aGlzLmlkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuXG4gICAgICAgIHRoaXMuaGlkZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICB2YXIgcGFyZW50VGFicyA9IHRoaXMudGFiLnBhcmVudE5vZGUuY2hpbGRyZW47XG4gICAgICAgICAgICB2YXIgc2VjdGlvbnNUYWJzID0gdGhpcy5pZC5wYXJlbnROb2RlLmNoaWxkcmVuO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcmVudFRhYnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRUYWJzW2ldLmNsYXNzTGlzdC5yZW1vdmUoJ3RhYnNfX2l0ZW0tLWFjdGl2ZScpO1xuICAgICAgICAgICAgfSAgICBcblxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWN0aW9uc1RhYnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBzZWN0aW9uc1RhYnNbal0uY2xhc3NMaXN0LnJlbW92ZSgndGFiLXNlY3Rpb24tLWFjdGl2ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHRoaXMudGFiLmNsYXNzTGlzdC5hZGQoJ3RhYnNfX2l0ZW0tLWFjdGl2ZScpO1xuICAgICAgICAgICAgdGhpcy5pZC5jbGFzc0xpc3QuYWRkKCd0YWItc2VjdGlvbi0tYWN0aXZlJyk7XG4gICAgICAgIH1cblxuICAgIH07XG5cblxuICAgICEgZnVuY3Rpb24oKXtcbiAgICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICAgIC8qIGdldCB0YWJzIGl0ZW0gKi9cbiAgICAgICAgdmFyIHRhYnMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCd0YWJzX19pdGVtJyk7XG5cbiAgICAgICAgLyogc2F2ZSBpbiBhcnJheSBhbGwgdGFicyAqL1xuICAgICAgICBjb25zdCB0YWJzQXJyYXkgPSBBcnJheS5mcm9tKHRhYnMpO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFicy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG15VGFiID0gdGFic1tpXTtcblxuICAgICAgICAgICAgLyogb24gY2xpY2sgaW4gdGFiICovXG4gICAgICAgICAgICBteVRhYi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgICAgICAgICAgIHZhciBpZCA9IHRoaXMuZ2V0QXR0cmlidXRlKCdzdGV3ZWQtdGFiLWlkJylcbiAgICAgICAgICAgICAgICB2YXIgdGFiID0gbmV3IFRhYnModGhpcywgaWQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCBpZCAhPT0gXCJmYWxzZVwiICkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoICghdGhpcy5jbGFzc0xpc3QuY29udGFpbnMoJ2Rpc2FibGVkJykpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWIuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFiLnNob3coKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7ICAgICAgICBcblxuICAgICAgICB9XG5cbiAgICAgICAgLyogVE9ETzogQ2hhbmdlIHRhYiB1c2luZyBrZXlib2FyZCAqL1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAndXNlIHN0cmljdCc7XG5cbiAgICAgICAgICAgIHN3aXRjaCAoZS5rZXlDb2RlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBLRVlfVVA6XG4gICAgICAgICAgICAgICAgY2FzZSBLRVlfTEVGVDpcbiAgICAgICAgICAgICAgICAgICAgaW5kZXgtLTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgS0VZX1JJR0hUOlxuICAgICAgICAgICAgICAgIGNhc2UgS0VZX0RPV046XG4gICAgICAgICAgICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OiBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGluZGV4IDwgMCkge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5kZXggPj0gdGFicy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBpbmRleCA9IHRhYnMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc29sZS5sb2coaW5kZXgpO1xuXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICB9KCk7XG5cblxuIiwidmFyIHRvYXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG5cbn07XG5cblxuIWZ1bmN0aW9uKCl7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIHRvYXN0KCk7XG59KCk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
