var Form=function(){"use strict";const t=document.querySelectorAll('[stewed-validate="true"]');for(var e=document.getElementsByClassName("textfield__input"),s=0;s<e.length;s++)if(!e[s].disabled){var i=e[s];i.parentNode.className="textfield",i.addEventListener("input",function(){if(t.length){const e=""==this.min?"tel"==this.type?9:2:this.min,s=""==this.max?"tel"==this.type?13:Number.MAX_SAFE_INTEGER:this.max,i=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;"select-one"==this.type?""!=this.value?this.parentNode.className="textfield textfield--valid":this.parentNode.className="textfield textfield--invalid":"textarea"==this.type?this.value.length>1?this.parentNode.className="textfield textfield--valid":0==this.value.length?this.parentNode.className="textfield":this.parentNode.className="textfield textfield--invalid":this.value.length>=e&&this.value.length<=s?"email"==this.type?i.test(this.value)?this.parentNode.className="textfield textfield--valid":this.parentNode.className="textfield textfield--invalid":this.parentNode.className="textfield textfield--valid":0==this.value.length?this.parentNode.className="textfield":this.parentNode.className="textfield textfield--invalid"}else this.value.length>1?this.parentNode.className="textfield textfield--filled":this.parentNode.className="textfield"})}};!function(){"use strict";new Form}();var Dropdown=function(t,e){"use strict";this.dropdown=t,this.id=document.getElementById(e),this.show=function(){if(this.id.classList.contains("dropdown--visible"))this.id.className+=" dropdown--animatable",this.id.classList.remove("dropdown--visible");else{var t=document.getElementsByClassName("dropdown--visible");t.length>0&&t[0].classList.remove("dropdown--visible"),this.id.className+=" dropdown--visible"}},this.id.addEventListener("transitionend",function(){this.classList.contains("dropdown--animatable")&&this.classList.remove("dropdown--animatable")})};!function(){"use strict";for(var t=document.querySelectorAll("[stewed-dropdown]"),e=0;e<t.length;e++){var s=t[e];s.addEventListener("click",function(){var t=this.getAttribute("stewed-dropdown"),e=new Dropdown(this,t);this.classList.contains("disabled")||e.show()})}}();var Modal=function(t){"use strict";var e=this;if(this.modal=document.getElementById(t),this.isOpen=!1,null!==this.modal){for(var s=this.modal.getElementsByClassName("modal-close"),i=0;i<s.length;i++){var n=s[i];n.addEventListener("click",function(){e.hide()})}this.modal.addEventListener("transitionend",function(){this.classList.contains("modal--animatable")&&this.classList.remove("modal--animatable")}),document.addEventListener("keyup",function(t){27===t.keyCode&&e.isOpen&&e.hide()})}this.show=function(){null!==this.modal&&(this.modal.classList.add("modal--visible"),this.isOpen=!0)},this.hide=function(){null!==this.modal&&(this.modal.classList.remove("modal--visible"),this.modal.classList.add("modal--animatable"),this.isOpen=!1)}};!function(){"use strict";for(var t=[],e=document.querySelectorAll("[stewed-modal]"),s=0;s<e.length;s++){var i=e[s],n=i.getAttribute("stewed-modal");t[n]=new Modal(n),i.addEventListener("click",function(){var e=this.getAttribute("stewed-modal"),s=t[e];s.isOpen?s.hide():s.show()})}}();var SideNav=function(){"use strict";var t=document.querySelector(".js-menu-show"),e=document.querySelector(".js-menu-hide"),s=document.querySelector(".js-side-nav"),i=document.querySelector(".js-side-nav-container"),n=!1,a=0,d=0;this.addEventListeners=function(){t&&t.addEventListener("click",this.showSideNav),e&&e.addEventListener("click",l),s&&s.addEventListener("click",l),i&&i.addEventListener("click",this.blockClicks),s&&(s.addEventListener("touchstart",this.onTouchStart),s.addEventListener("touchmove",this.onTouchMove),s.addEventListener("touchend",this.onTouchEnd))},this.blockClicks=function(t){t.stopPropagation()};var o=function(t){s.classList.remove("side-nav--animatable"),s.removeEventListener("transitionend",o)};this.showSideNav=function(){s.classList.add("side-nav--animatable"),s.classList.add("side-nav--visible"),s.addEventListener("transitionend",o),document.body.style.overflow="hidden"};var l=function(){s.classList.add("side-nav--animatable"),s.classList.remove("side-nav--visible"),s.addEventListener("transitionend",o),document.body.style.overflow=""};this.onTouchStart=function(t){s.classList.contains("side-nav--visible")&&(a=t.touches[0].pageX,d=a,n=!0,requestAnimationFrame(function(){c()}))},this.onTouchMove=function(t){if(n){d=t.touches[0].pageX;const e=Math.min(0,d-a);e<0&&t.preventDefault()}},this.onTouchEnd=function(t){if(n){n=!1;const e=Math.min(0,d-a);i.style.transform="",e<0&&l()}};var c=function(){if(n){requestAnimationFrame(function(){c()});const t=Math.min(0,d-a);i.style.transform="translateX("+t+"px)"}}};!function(){"use strict";var t=new SideNav;t.addEventListeners()}();var snackbar=function(t){"use strict";var e=this;if(this.snackbar=document.getElementById(t),this.isOpen=!1,null!==this.snackbar){for(var s=this.snackbar.getElementsByClassName("snackbar-close"),i=0;i<s.length;i++){var n=s[i];n.addEventListener("click",function(){e.hide()})}this.snackbar.addEventListener("transitionend",function(){this.classList.contains("snackbar--animatable")&&this.classList.remove("snackbar--animatable")}),document.addEventListener("keyup",function(t){27===t.keyCode&&e.isOpen&&e.hide()})}this.show=function(){null!==this.snackbar&&(this.snackbar.classList.add("snackbar--visible"),this.isOpen=!0)},this.hide=function(){null!==this.snackbar&&(this.snackbar.classList.remove("snackbar--visible"),this.snackbar.classList.add("snackbar--animatable"),this.isOpen=!1)}};!function(){"use strict";for(var t=[],e=document.querySelectorAll("[stewed-snackbar]"),s=0;s<e.length;s++){var i=e[s],n=i.getAttribute("stewed-snackbar");t[n]=new snackbar(n),i.addEventListener("click",function(){var e=this.getAttribute("stewed-snackbar"),s=t[e];s.isOpen?s.hide():s.show()})}}();var Tabs=function(t,e){"use strict";this.tab=t,this.id=document.getElementById(e),this.hide=function(){for(var t=this.tab.parentNode.children,e=this.id.parentNode.children,s=0;s<t.length;s++)t[s].classList.remove("tabs__item--active");for(var i=0;i<e.length;i++)e[i].classList.remove("tab-section--active")},this.show=function(){this.tab.classList.add("tabs__item--active"),this.id.classList.add("tab-section--active")}};!function(){"use strict";var t=document.getElementsByClassName("tabs__item");Array.from(t);for(var e=0;e<t.length;e++){var s=t[e];s.addEventListener("click",function(){var t=this.getAttribute("stewed-tab-id"),e=new Tabs(this,t);"false"!==t&&(this.classList.contains("disabled")||(e.hide(),e.show()))})}window.addEventListener("keypress",function(e){index<0?index=0:index>=t.length&&(index=t.length-1),console.log(index)})}();var toast=function(){"use strict"};!function(){"use strict";toast()}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZvcm0vZm9ybS5qcyIsImRyb3Bkb3duL2Ryb3Bkb3duLmpzIiwibW9kYWwvbW9kYWwuanMiLCJzaWRlbmF2L3NpZGVuYXYuanMiLCJzbmFja2Jhci9zbmFja2Jhci5qcyIsInRhYnMvdGFicy5qcyIsInRvYXN0L3RvYXN0LmpzIl0sIm5hbWVzIjpbIkZvcm0iLCJWQUxJREFURSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0cyIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJpIiwibGVuZ3RoIiwiZGlzYWJsZWQiLCJpbnB1dCIsInBhcmVudE5vZGUiLCJjbGFzc05hbWUiLCJhZGRFdmVudExpc3RlbmVyIiwiTUlOIiwidGhpcyIsIm1pbiIsInR5cGUiLCJNQVgiLCJtYXgiLCJOdW1iZXIiLCJNQVhfU0FGRV9JTlRFR0VSIiwiRU1BSUwiLCJ2YWx1ZSIsInRlc3QiLCJEcm9wZG93biIsInNlbGVjdGVkIiwiaWQiLCJkcm9wZG93biIsImdldEVsZW1lbnRCeUlkIiwic2hvdyIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwicmVtb3ZlIiwiZWxlbWVudHMiLCJlbGVtcyIsIm15RHJvcGRvd24iLCJnZXRBdHRyaWJ1dGUiLCJNb2RhbCIsIm1vZGFsSWQiLCJfc2VsZiIsIm1vZGFsIiwiaXNPcGVuIiwiY2xvc2VCdXR0b25zIiwiYnRuX2Nsb3NlIiwiaGlkZSIsImUiLCJrZXlDb2RlIiwiYWRkIiwibWVtb3J5X21vZGFscyIsImVsZW0iLCJjdXJyZW50X21vZGFsIiwiU2lkZU5hdiIsIiRzaG93QnV0dG9uRWwiLCJxdWVyeVNlbGVjdG9yIiwiJGhpZGVCdXR0b25FbCIsIiRzaWRlTmF2RWwiLCIkc2lkZU5hdkNvbnRhaW5lckVsIiwidG91Y2hpbmdTaWRlTmF2Iiwic3RhcnRYIiwiY3VycmVudFgiLCJhZGRFdmVudExpc3RlbmVycyIsInNob3dTaWRlTmF2IiwiaGlkZVNpZGVOYXYiLCJibG9ja0NsaWNrcyIsIm9uVG91Y2hTdGFydCIsIm9uVG91Y2hNb3ZlIiwib25Ub3VjaEVuZCIsImV2dCIsInN0b3BQcm9wYWdhdGlvbiIsIm9uVHJhbnNpdGlvbkVuZCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJib2R5Iiwic3R5bGUiLCJvdmVyZmxvdyIsInRvdWNoZXMiLCJwYWdlWCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsInVwZGF0ZSIsInRyYW5zbGF0ZVgiLCJNYXRoIiwicHJldmVudERlZmF1bHQiLCJ0cmFuc2Zvcm0iLCJzaWRlbmF2Iiwic25hY2tiYXIiLCJzbmFja2JhcklkIiwibWVtb3J5X3NuYWNrYmFycyIsImN1cnJlbnRfc25hY2tiYXIiLCJUYWJzIiwidGFiIiwicGFyZW50VGFicyIsImNoaWxkcmVuIiwic2VjdGlvbnNUYWJzIiwiaiIsInRhYnMiLCJBcnJheSIsImZyb20iLCJteVRhYiIsIndpbmRvdyIsImluZGV4IiwiY29uc29sZSIsImxvZyIsInRvYXN0Il0sIm1hcHBpbmdzIjoiQUFBQSxHQUFBQSxNQUFBLFdBQ0EsWUFFQSxNQUFBQyxHQUFBQyxTQUFBQyxpQkFBQSwyQkFHQSxLQUFBLEdBRkFDLEdBQUFGLFNBQUFHLHVCQUFBLG9CQUVBQyxFQUFBLEVBQUFBLEVBQUFGLEVBQUFHLE9BQUFELElBRUEsSUFBQUYsRUFBQUUsR0FBQUUsU0FBQSxDQUNBLEdBQUFDLEdBQUFMLEVBQUFFLEVBQ0FHLEdBQUFDLFdBQUFDLFVBQUEsWUFFQUYsRUFBQUcsaUJBQUEsUUFBQSxXQUdBLEdBQUFYLEVBQUFNLE9BQUEsQ0FDQSxLQUFBTSxHQUFBLElBQUFDLEtBQUFDLElBQUEsT0FBQUQsS0FBQUUsS0FBQSxFQUFBLEVBQUFGLEtBQUFDLElBQ0FFLEVBQUEsSUFBQUgsS0FBQUksSUFBQSxPQUFBSixLQUFBRSxLQUFBLEdBQUFHLE9BQUFDLGlCQUFBTixLQUFBSSxJQUNBRyxFQUFBLG9GQUVBLGVBQUFQLEtBQUFFLEtBQ0EsSUFBQUYsS0FBQVEsTUFDQVIsS0FBQUosV0FBQUMsVUFBQSw2QkFFQUcsS0FBQUosV0FBQUMsVUFBQSwrQkFF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QUFBQSxFQUFBbUYsRUFBQWxGLE9BQUFELElBQ0FtRixFQUFBbkYsR0FBQXdCLFVBQUFFLE9BQUEscUJBR0EsS0FBQSxHQUFBNEQsR0FBQSxFQUFBQSxFQUFBRCxFQUFBcEYsT0FBQXFGLElBQ0FELEVBQUFDLEdBQUE5RCxVQUFBRSxPQUFBLHdCQUlBbEIsS0FBQWUsS0FBQSxXQUNBZixLQUFBMEUsSUFBQTFELFVBQUFpQixJQUFBLHNCQUNBakMsS0FBQVksR0FBQUksVUFBQWlCLElBQUEsMEJBTUEsV0FDQSxZQUdBLElBQUE4QyxHQUFBM0YsU0FBQUcsdUJBQUEsYUFHQXlGLE9BQUFDLEtBQUFGLEVBRUEsS0FBQSxHQUFBdkYsR0FBQSxFQUFBQSxFQUFBdUYsRUFBQXRGLE9BQUFELElBQUEsQ0FDQSxHQUFBMEYsR0FBQUgsRUFBQXZGLEVBR0EwRixHQUFBcEYsaUJBQUEsUUFBQSxXQUdBLEdBQUFjLEdBQUFaLEtBQUFzQixhQUFBLGlCQUNBb0QsRUFBQSxHQUFBRCxNQUFBekUsS0FBQVksRUFFQSxXQUFBQSxJQUNBWixLQUFBZ0IsVUFBQUMsU0FBQSxjQUNBeUQsRUFBQTVDLE9BQ0E0QyxFQUFBM0QsV0FTQW9FLE9BQUFyRixpQkFBQSxXQUFBLFNBQUFpQyxHQWlCQXFELE1BQUEsRUFDQUEsTUFBQSxFQUNBQSxPQUFBTCxFQUFBdEYsU0FDQTJGLE1BQUFMLEVBQUF0RixPQUFBLEdBR0E0RixRQUFBQyxJQUFBRixXQ3RGQSxJQUFBRyxPQUFBLFdBQ0EsZUFNQSxXQUNBLFlBQ0FBIiwiZmlsZSI6InN0ZXdlZC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBGb3JtID0gZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGNvbnN0IFZBTElEQVRFID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW3N0ZXdlZC12YWxpZGF0ZT1cInRydWVcIl0nKTtcbiAgICB2YXIgaW5wdXRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndGV4dGZpZWxkX19pbnB1dCcpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnB1dHMubGVuZ3RoOyBpKyspIHtcblxuICAgICAgICBpZiAoISBpbnB1dHNbaV0uZGlzYWJsZWQpIHtcbiAgICAgICAgICAgIHZhciBpbnB1dCA9IGlucHV0c1tpXTtcbiAgICAgICAgICAgIGlucHV0LnBhcmVudE5vZGUuY2xhc3NOYW1lID0gJ3RleHRmaWVsZCc7XG5cbiAgICAgICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICAgICAgICAgICAgaWYgKFZBTElEQVRFLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBNSU4gPSAodGhpcy5taW4gPT0gJycpID8gKCh0aGlzLnR5cGUgPT0gJ3RlbCcpID8gOSA6IDIgKSA6IHRoaXMubWluLFxuICAgICAgICAgICAgICAgICAgICBNQVggPSAodGhpcy5tYXggPT0gJycpID8gKCh0aGlzLnR5cGUgPT0gJ3RlbCcpID8gMTMgOiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiApIDogdGhpcy5tYXgsXG4gICAgICAgICAgICAgICAgICAgIEVNQUlMID0gL14oW1xcdy1dKyg/OlxcLltcXHctXSspKilAKCg/OltcXHctXStcXC4pKlxcd1tcXHctXXswLDY2fSlcXC4oW2Etel17Miw2fSg/OlxcLlthLXpdezJ9KT8pJC9pO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnR5cGUgPT0gJ3NlbGVjdC1vbmUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy52YWx1ZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLmNsYXNzTmFtZSA9ICd0ZXh0ZmllbGQgdGV4dGZpZWxkLS12YWxpZCc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5jbGFzc05hbWUgPSAndGV4dGZpZWxkIHRleHRmaWVsZC0taW52YWxpZCc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy50eXBlID09ICd0ZXh0YXJlYScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudE5vZGUuY2xhc3NOYW1lID0gJ3RleHRmaWVsZCB0ZXh0ZmllbGQtLXZhbGlkJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy52YWx1ZS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5jbGFzc05hbWUgPSAndGV4dGZpZWxkJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLmNsYXNzTmFtZSA9ICd0ZXh0ZmllbGQgdGV4dGZpZWxkLS1pbnZhbGlkJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggKHRoaXMudmFsdWUubGVuZ3RoID49IE1JTiApICYmICh0aGlzLnZhbHVlLmxlbmd0aCA8PSBNQVgpICkgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy50eXBlID09ICdlbWFpbCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEVNQUlMLnRlc3QodGhpcy52YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5jbGFzc05hbWUgPSAndGV4dGZpZWxkIHRleHRmaWVsZC0tdmFsaWQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLmNsYXNzTmFtZSA9ICd0ZXh0ZmllbGQgdGV4dGZpZWxkLS1pbnZhbGlkJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5jbGFzc05hbWUgPSAndGV4dGZpZWxkIHRleHRmaWVsZC0tdmFsaWQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy52YWx1ZS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5jbGFzc05hbWUgPSAndGV4dGZpZWxkJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLmNsYXNzTmFtZSA9ICd0ZXh0ZmllbGQgdGV4dGZpZWxkLS1pbnZhbGlkJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5jbGFzc05hbWUgPSAndGV4dGZpZWxkIHRleHRmaWVsZC0tZmlsbGVkJztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5jbGFzc05hbWUgPSAndGV4dGZpZWxkJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuIWZ1bmN0aW9uKCl7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIG5ldyBGb3JtKCk7XG59KCk7IiwiICAgIHZhciBEcm9wZG93biA9IGZ1bmN0aW9uKHNlbGVjdGVkLCBpZCkge1xuICAgICAgICAndXNlIHN0cmljdCc7XG5cbiAgICAgICAgdGhpcy5kcm9wZG93biA9IHNlbGVjdGVkO1xuICAgICAgICB0aGlzLmlkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuXG5cbiAgICAgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgaWYgKCF0aGlzLmlkLmNsYXNzTGlzdC5jb250YWlucygnZHJvcGRvd24tLXZpc2libGUnKSkge1xuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2Ryb3Bkb3duLS12aXNpYmxlJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50c1swXS5jbGFzc0xpc3QucmVtb3ZlKFwiZHJvcGRvd24tLXZpc2libGVcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuaWQuY2xhc3NOYW1lICs9IFwiIGRyb3Bkb3duLS12aXNpYmxlXCI7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pZC5jbGFzc05hbWUgKz0gXCIgZHJvcGRvd24tLWFuaW1hdGFibGVcIjtcbiAgICAgICAgICAgICAgICB0aGlzLmlkLmNsYXNzTGlzdC5yZW1vdmUoXCJkcm9wZG93bi0tdmlzaWJsZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuaWQuYWRkRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIiwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGlmICh0aGlzLmNsYXNzTGlzdC5jb250YWlucygnZHJvcGRvd24tLWFuaW1hdGFibGUnKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xhc3NMaXN0LnJlbW92ZSgnZHJvcGRvd24tLWFuaW1hdGFibGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICB9O1xuXG5cbiAgICAhIGZ1bmN0aW9uKCl7XG4gICAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgICAvKiBnZXQgZHJvcGRvd24gaXRlbSAqL1xuICAgICAgICB2YXIgZWxlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbc3Rld2VkLWRyb3Bkb3duXScpO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbXMubGVuZ3RoOyBpKyspIHtcblxuICAgICAgICAgICAgdmFyIG15RHJvcGRvd24gPSBlbGVtc1tpXTtcblxuICAgICAgICAgICAgLyogb24gY2xpY2sgaW4gdGFiICovXG4gICAgICAgICAgICBteURyb3Bkb3duLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICAgICAgICAgICAgdmFyIGlkID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ3N0ZXdlZC1kcm9wZG93bicpXG4gICAgICAgICAgICAgICAgdmFyIGRyb3Bkb3duID0gbmV3IERyb3Bkb3duKHRoaXMsIGlkKTtcblxuICAgICAgICAgICAgICAgIGlmICggIXRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKCdkaXNhYmxlZCcpICkge1xuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5zaG93KCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTsgICAgICAgIFxuXG4gICAgICAgIH1cblxuICAgIH0oKTtcblxuXG4iLCJ2YXIgTW9kYWwgPSBmdW5jdGlvbihtb2RhbElkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIF9zZWxmID0gdGhpcztcbiAgICB2YXIgbnVtID0gMTtcblxuICAgIHRoaXMubW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChtb2RhbElkKTtcbiAgICB0aGlzLmlzT3BlbiA9IGZhbHNlO1xuICAgIFxuICAgIC8qIENvbnN0cnVjdG9yICovXG4gICAgaWYodGhpcy5tb2RhbCAhPT0gbnVsbCkge1xuXG4gICAgICAgIHZhciBjbG9zZUJ1dHRvbnMgPSB0aGlzLm1vZGFsLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ21vZGFsLWNsb3NlJyk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2xvc2VCdXR0b25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYnRuX2Nsb3NlID0gY2xvc2VCdXR0b25zW2ldO1xuICAgICAgICAgICAgYnRuX2Nsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBfc2VsZi5oaWRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5tb2RhbC5hZGRFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgaWYodGhpcy5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsLS1hbmltYXRhYmxlJykpe1xuICAgICAgICAgICAgICAgIHRoaXMuY2xhc3NMaXN0LnJlbW92ZSgnbW9kYWwtLWFuaW1hdGFibGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vYWRkIGtleSBjbG9zZSBldmVudFxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICd1c2Ugc3RyaWN0J1xuXG4gICAgICAgICAgICBpZihlLmtleUNvZGUgPT09IDI3ICYmIF9zZWxmLmlzT3Blbikge1xuICAgICAgICAgICAgICAgIF9zZWxmLmhpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyogU2hvdyBDdXJyZW50IE1vZGFsICovXG4gICAgdGhpcy5zaG93ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZih0aGlzLm1vZGFsICE9PSBudWxsKXtcbiAgICAgICAgICAgIHRoaXMubW9kYWwuY2xhc3NMaXN0LmFkZCgnbW9kYWwtLXZpc2libGUnKTtcbiAgICAgICAgICAgIHRoaXMuaXNPcGVuID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvKiBIaWRlIEN1cnJlbnQgTW9kYWwgKi9cbiAgICB0aGlzLmhpZGUgPSBmdW5jdGlvbigpe1xuICAgICAgICBpZih0aGlzLm1vZGFsICE9PSBudWxsKXtcbiAgICAgICAgICAgIHRoaXMubW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnbW9kYWwtLXZpc2libGUnKTtcbiAgICAgICAgICAgIHRoaXMubW9kYWwuY2xhc3NMaXN0LmFkZCgnbW9kYWwtLWFuaW1hdGFibGUnKTtcbiAgICAgICAgICAgIHRoaXMuaXNPcGVuID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xufTtcblxuXG4hIGZ1bmN0aW9uKCl7XG4gICAndXNlIHN0cmljdCc7XG5cbiAgIHZhciBtZW1vcnlfbW9kYWxzID0gW107XG4gICB2YXIgZWxlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbc3Rld2VkLW1vZGFsXScpO1xuXG4gICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGVsZW0gPSBlbGVtc1tpXTtcbiAgICB2YXIgbW9kYWxJZCA9IGVsZW0uZ2V0QXR0cmlidXRlKCdzdGV3ZWQtbW9kYWwnKTtcbiAgICBtZW1vcnlfbW9kYWxzW21vZGFsSWRdID0gbmV3IE1vZGFsKG1vZGFsSWQpO1xuXG4gICAgLyogRWVsZW1lbnQgY2xpY2sgKi9cbiAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgICB2YXIgY3VycmVudF9tb2RhbCA9IHRoaXMuZ2V0QXR0cmlidXRlKCdzdGV3ZWQtbW9kYWwnKTtcbiAgICAgICAgdmFyIG1vZGFsID0gbWVtb3J5X21vZGFsc1tjdXJyZW50X21vZGFsXTtcblxuICAgICAgICBpZiAobW9kYWwuaXNPcGVuKSB7XG4gICAgICAgICAgICBtb2RhbC5oaWRlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtb2RhbC5zaG93KCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbn0oKTsiLCJ2YXIgU2lkZU5hdiA9IGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciAkc2hvd0J1dHRvbkVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLW1lbnUtc2hvdycpLFxuICAgICRoaWRlQnV0dG9uRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtbWVudS1oaWRlJyksXG4gICAgJHNpZGVOYXZFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1zaWRlLW5hdicpLFxuICAgICRzaWRlTmF2Q29udGFpbmVyRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtc2lkZS1uYXYtY29udGFpbmVyJyksXG4gICAgdG91Y2hpbmdTaWRlTmF2ID0gZmFsc2UsXG4gICAgc3RhcnRYID0gMCxcbiAgICBjdXJyZW50WCA9IDA7XG5cbiAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXJzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIGlmICgkc2hvd0J1dHRvbkVsKSB7XG4gICAgICAgICAgICAkc2hvd0J1dHRvbkVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5zaG93U2lkZU5hdik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoJGhpZGVCdXR0b25FbCkge1xuICAgICAgICAgICAgJGhpZGVCdXR0b25FbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhpZGVTaWRlTmF2KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICgkc2lkZU5hdkVsKSB7XG4gICAgICAgICAgICAkc2lkZU5hdkVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGlkZVNpZGVOYXYpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCRzaWRlTmF2Q29udGFpbmVyRWwpIHtcbiAgICAgICAgICAgICRzaWRlTmF2Q29udGFpbmVyRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmJsb2NrQ2xpY2tzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICgkc2lkZU5hdkVsKSB7XG4gICAgICAgICAgICAkc2lkZU5hdkVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB0aGlzLm9uVG91Y2hTdGFydCk7XG4gICAgICAgICAgICAkc2lkZU5hdkVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMub25Ub3VjaE1vdmUpO1xuICAgICAgICAgICAgJHNpZGVOYXZFbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHRoaXMub25Ub3VjaEVuZCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmJsb2NrQ2xpY2tzID0gZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9XG5cbiAgICB2YXIgb25UcmFuc2l0aW9uRW5kID0gZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgICRzaWRlTmF2RWwuY2xhc3NMaXN0LnJlbW92ZSgnc2lkZS1uYXYtLWFuaW1hdGFibGUnKTtcbiAgICAgICAgJHNpZGVOYXZFbC5yZW1vdmVFdmVudExpc3RlbmVyKCd0cmFuc2l0aW9uZW5kJywgb25UcmFuc2l0aW9uRW5kKTtcbiAgICB9XG5cbiAgICB0aGlzLnNob3dTaWRlTmF2ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICRzaWRlTmF2RWwuY2xhc3NMaXN0LmFkZCgnc2lkZS1uYXYtLWFuaW1hdGFibGUnKTtcbiAgICAgICAgJHNpZGVOYXZFbC5jbGFzc0xpc3QuYWRkKCdzaWRlLW5hdi0tdmlzaWJsZScpO1xuICAgICAgICAkc2lkZU5hdkVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCBvblRyYW5zaXRpb25FbmQpO1xuICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gXCJoaWRkZW5cIjtcbiAgICB9XG5cbiAgICB2YXIgaGlkZVNpZGVOYXYgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgJHNpZGVOYXZFbC5jbGFzc0xpc3QuYWRkKCdzaWRlLW5hdi0tYW5pbWF0YWJsZScpO1xuICAgICAgICAkc2lkZU5hdkVsLmNsYXNzTGlzdC5yZW1vdmUoJ3NpZGUtbmF2LS12aXNpYmxlJyk7XG4gICAgICAgICRzaWRlTmF2RWwuYWRkRXZlbnRMaXN0ZW5lcigndHJhbnNpdGlvbmVuZCcsIG9uVHJhbnNpdGlvbkVuZCk7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSBcIlwiO1xuICAgIH1cblxuICAgIHRoaXMub25Ub3VjaFN0YXJ0ID0gZnVuY3Rpb24oZXZ0KSB7XG5cbiAgICAgICAgaWYgKCEkc2lkZU5hdkVsLmNsYXNzTGlzdC5jb250YWlucygnc2lkZS1uYXYtLXZpc2libGUnKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgc3RhcnRYID0gZXZ0LnRvdWNoZXNbMF0ucGFnZVg7XG4gICAgICAgIGN1cnJlbnRYID0gc3RhcnRYO1xuICAgICAgICB0b3VjaGluZ1NpZGVOYXYgPSB0cnVlO1xuXG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHVwZGF0ZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLm9uVG91Y2hNb3ZlID0gZnVuY3Rpb24oZXZ0KSB7XG5cbiAgICAgICAgaWYgKCF0b3VjaGluZ1NpZGVOYXYpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGN1cnJlbnRYID0gZXZ0LnRvdWNoZXNbMF0ucGFnZVg7XG4gICAgICAgIGNvbnN0IHRyYW5zbGF0ZVggPSBNYXRoLm1pbigwLCBjdXJyZW50WCAtIHN0YXJ0WCk7XG5cbiAgICAgICAgaWYgKHRyYW5zbGF0ZVggPCAwKSB7XG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMub25Ub3VjaEVuZCA9IGZ1bmN0aW9uKGV2dCkge1xuXG4gICAgICAgIGlmICghdG91Y2hpbmdTaWRlTmF2KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0b3VjaGluZ1NpZGVOYXYgPSBmYWxzZTtcblxuICAgICAgICBjb25zdCB0cmFuc2xhdGVYID0gTWF0aC5taW4oMCwgY3VycmVudFggLSBzdGFydFgpO1xuICAgICAgICAkc2lkZU5hdkNvbnRhaW5lckVsLnN0eWxlLnRyYW5zZm9ybSA9ICcnO1xuXG4gICAgICAgIGlmICh0cmFuc2xhdGVYIDwgMCkge1xuICAgICAgICAgICAgaGlkZVNpZGVOYXYoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZhciB1cGRhdGUgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICBpZiAoIXRvdWNoaW5nU2lkZU5hdikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdXBkYXRlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHRyYW5zbGF0ZVggPSBNYXRoLm1pbigwLCBjdXJyZW50WCAtIHN0YXJ0WCk7XG5cbiAgICAgICAgJHNpZGVOYXZDb250YWluZXJFbC5zdHlsZS50cmFuc2Zvcm0gPSBcInRyYW5zbGF0ZVgoXCIgKyB0cmFuc2xhdGVYICsgXCJweClcIjtcblxuICAgIH1cblxuXG59O1xuXG5cbiEgZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIHNpZGVuYXYgPSBuZXcgU2lkZU5hdigpO1xuICAgIHNpZGVuYXYuYWRkRXZlbnRMaXN0ZW5lcnMoKTtcblxufSgpO1xuIiwidmFyIHNuYWNrYmFyID0gZnVuY3Rpb24oc25hY2tiYXJJZCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBfc2VsZiA9IHRoaXM7XG4gICAgdmFyIG51bSA9IDE7XG4gICAgXG4gICAgdGhpcy5zbmFja2JhciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNuYWNrYmFySWQpO1xuICAgIHRoaXMuaXNPcGVuID0gZmFsc2U7XG5cbiAgICAvKiBDb25zdHJ1Y3RvciAqL1xuICAgIGlmICh0aGlzLnNuYWNrYmFyICE9PSBudWxsKSB7XG5cbiAgICAgICAgdmFyIGNsb3NlQnV0dG9ucyA9IHRoaXMuc25hY2tiYXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc25hY2tiYXItY2xvc2UnKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjbG9zZUJ1dHRvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBidG5fY2xvc2UgPSBjbG9zZUJ1dHRvbnNbaV07XG4gICAgICAgICAgICBidG5fY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIF9zZWxmLmhpZGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNuYWNrYmFyLmFkZEV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5jbGFzc0xpc3QuY29udGFpbnMoJ3NuYWNrYmFyLS1hbmltYXRhYmxlJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsYXNzTGlzdC5yZW1vdmUoJ3NuYWNrYmFyLS1hbmltYXRhYmxlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8qIEFkZCBrZXkgY2xvc2UgZXZlbnQgKi9cbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAndXNlIHN0cmljdCc7XG4gICAgICAgICAgICBpZihlLmtleUNvZGUgPT09IDI3ICYmIF9zZWxmLmlzT3Blbil7XG4gICAgICAgICAgICAgICAgX3NlbGYuaGlkZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKiBTaG93IEN1cnJlbnQgc25hY2tiYXIgKi9cbiAgICB0aGlzLnNob3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKHRoaXMuc25hY2tiYXIgIT09IG51bGwpe1xuICAgICAgICAgICAgdGhpcy5zbmFja2Jhci5jbGFzc0xpc3QuYWRkKCdzbmFja2Jhci0tdmlzaWJsZScpO1xuICAgICAgICAgICAgdGhpcy5pc09wZW4gPSB0cnVlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8qIEhpZGUgQ3VycmVudCBzbmFja2JhciAqL1xuICAgIHRoaXMuaGlkZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGlmKHRoaXMuc25hY2tiYXIgIT09IG51bGwpe1xuICAgICAgICAgICAgdGhpcy5zbmFja2Jhci5jbGFzc0xpc3QucmVtb3ZlKCdzbmFja2Jhci0tdmlzaWJsZScpO1xuICAgICAgICAgICAgdGhpcy5zbmFja2Jhci5jbGFzc0xpc3QuYWRkKCdzbmFja2Jhci0tYW5pbWF0YWJsZScpO1xuICAgICAgICAgICAgdGhpcy5pc09wZW4gPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG5cbn07XG5cbi8vU0hPVyBzbmFja2JhclxuISBmdW5jdGlvbigpe1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBtZW1vcnlfc25hY2tiYXJzID0gW107XG4gICAgdmFyIGVsZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW3N0ZXdlZC1zbmFja2Jhcl0nKTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGVsZW0gPSBlbGVtc1tpXTtcbiAgICAgICAgdmFyIHNuYWNrYmFySWQgPSBlbGVtLmdldEF0dHJpYnV0ZSgnc3Rld2VkLXNuYWNrYmFyJyk7XG4gICAgICAgIG1lbW9yeV9zbmFja2JhcnNbc25hY2tiYXJJZF0gPSBuZXcgc25hY2tiYXIoc25hY2tiYXJJZCk7XG5cbiAgICAgICAgLyogRWxlbWVudCBjbGljayAqL1xuICAgICAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgICAgICAgdmFyIGN1cnJlbnRfc25hY2tiYXIgPSB0aGlzLmdldEF0dHJpYnV0ZSgnc3Rld2VkLXNuYWNrYmFyJyk7XG4gICAgICAgICAgICB2YXIgc25hY2tiYXIgPSBtZW1vcnlfc25hY2tiYXJzW2N1cnJlbnRfc25hY2tiYXJdO1xuXG4gICAgICAgICAgICBpZiAoc25hY2tiYXIuaXNPcGVuKSB7XG4gICAgICAgICAgICAgICAgc25hY2tiYXIuaGlkZSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzbmFja2Jhci5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn0oKTsiLCIgICAgdmFyIFRhYnMgPSBmdW5jdGlvbihzZWxlY3RlZCwgaWQpIHtcbiAgICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICAgIGNvbnN0IEtFWV9MRUZUID0gMzcsXG4gICAgICAgICAgICBLRVlfVVAgPSAzOCxcbiAgICAgICAgICAgIEtFWV9SSUdIVCA9IDM5LFxuICAgICAgICAgICAgS0VZX0RPV04gPSA0MDtcblxuICAgICAgICB0aGlzLnRhYiA9IHNlbGVjdGVkO1xuICAgICAgICB0aGlzLmlkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuXG4gICAgICAgIHRoaXMuaGlkZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICB2YXIgcGFyZW50VGFicyA9IHRoaXMudGFiLnBhcmVudE5vZGUuY2hpbGRyZW47XG4gICAgICAgICAgICB2YXIgc2VjdGlvbnNUYWJzID0gdGhpcy5pZC5wYXJlbnROb2RlLmNoaWxkcmVuO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcmVudFRhYnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRUYWJzW2ldLmNsYXNzTGlzdC5yZW1vdmUoJ3RhYnNfX2l0ZW0tLWFjdGl2ZScpO1xuICAgICAgICAgICAgfSAgICBcblxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWN0aW9uc1RhYnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBzZWN0aW9uc1RhYnNbal0uY2xhc3NMaXN0LnJlbW92ZSgndGFiLXNlY3Rpb24tLWFjdGl2ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHRoaXMudGFiLmNsYXNzTGlzdC5hZGQoJ3RhYnNfX2l0ZW0tLWFjdGl2ZScpO1xuICAgICAgICAgICAgdGhpcy5pZC5jbGFzc0xpc3QuYWRkKCd0YWItc2VjdGlvbi0tYWN0aXZlJyk7XG4gICAgICAgIH1cblxuICAgIH07XG5cblxuICAgICEgZnVuY3Rpb24oKXtcbiAgICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICAgIC8qIGdldCB0YWJzIGl0ZW0gKi9cbiAgICAgICAgdmFyIHRhYnMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCd0YWJzX19pdGVtJyk7XG5cbiAgICAgICAgLyogc2F2ZSBpbiBhcnJheSBhbGwgdGFicyAqL1xuICAgICAgICBjb25zdCB0YWJzQXJyYXkgPSBBcnJheS5mcm9tKHRhYnMpO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFicy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG15VGFiID0gdGFic1tpXTtcblxuICAgICAgICAgICAgLyogb24gY2xpY2sgaW4gdGFiICovXG4gICAgICAgICAgICBteVRhYi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgICAgICAgICAgIHZhciBpZCA9IHRoaXMuZ2V0QXR0cmlidXRlKCdzdGV3ZWQtdGFiLWlkJylcbiAgICAgICAgICAgICAgICB2YXIgdGFiID0gbmV3IFRhYnModGhpcywgaWQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCBpZCAhPT0gXCJmYWxzZVwiICkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoICghdGhpcy5jbGFzc0xpc3QuY29udGFpbnMoJ2Rpc2FibGVkJykpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWIuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFiLnNob3coKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7ICAgICAgICBcblxuICAgICAgICB9XG5cbiAgICAgICAgLyogVE9ETzogQ2hhbmdlIHRhYiB1c2luZyBrZXlib2FyZCAqL1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAndXNlIHN0cmljdCc7XG5cbiAgICAgICAgICAgIC8vIHN3aXRjaCAoZS5rZXlDb2RlKSB7XG4gICAgICAgICAgICAvLyAgICAgY2FzZSBLRVlfVVA6XG4gICAgICAgICAgICAvLyAgICAgY2FzZSBLRVlfTEVGVDpcbiAgICAgICAgICAgIC8vICAgICAgICAgaW5kZXgtLTtcbiAgICAgICAgICAgIC8vICAgICBicmVhaztcblxuICAgICAgICAgICAgLy8gICAgIGNhc2UgS0VZX1JJR0hUOlxuICAgICAgICAgICAgLy8gICAgIGNhc2UgS0VZX0RPV046XG4gICAgICAgICAgICAvLyAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgICAvLyAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIC8vICAgICBkZWZhdWx0OiBicmVhaztcbiAgICAgICAgICAgIC8vIH1cblxuICAgICAgICAgICAgaWYgKGluZGV4IDwgMCkge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5kZXggPj0gdGFicy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBpbmRleCA9IHRhYnMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc29sZS5sb2coaW5kZXgpO1xuXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICB9KCk7XG5cblxuIiwidmFyIHRvYXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG5cbn07XG5cblxuIWZ1bmN0aW9uKCl7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIHRvYXN0KCk7XG59KCk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
