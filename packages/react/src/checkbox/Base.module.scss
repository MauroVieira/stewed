@use 'sass:map';
@use '../theme/scss' as theme;
@use './variables' as *;

@include theme.scope($checkbox-root) {
    --checkbox-border: #{map.get($checkbox-skins-default, border)};
    --checkbox-border-hover: #{map.get(
            $checkbox-skins-default,
            border-hover
        )};
    --checkbox-border-checked: #{map.get(
            $checkbox-skins-default,
            border-checked
        )};
    --checkbox-size: #{map.get($checkbox-size, md)};
    --checkbox-font-size: #{map.get($checkbox-font-size, md)};
    --checkbox-border-size: #{map.get($checkbox-border-size, md)};

    position: relative;
    display: inline-flex;
    flex: 0 0 auto;
    align-items: center;
    justify-content: center;
    width: var(--checkbox-size);
    height: var(--checkbox-size);
    font-size: var(--checkbox-font-size);
    border-radius: 50%;
    outline: 0;
    cursor: pointer;
    overflow: hidden;

    &::before {
        position: absolute;
        width: 100%;
        height: 100%;
        transform: scale(0, 0);
        border-radius: 50%;
        background-color: var(--checkbox-border);
        opacity: 0;
        content: '';
    }

    @include theme.focus-styles();

    &:hover,
    &:active,
    &:focus {
        #{$checkbox-root}__background {
            color: var(--checkbox-border-hover);
        }
    }

    &__control {
        position: absolute;
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        border: 0;
        opacity: 0;
        cursor: pointer;
        overflow: hidden;
        z-index: 1;

        &:checked {
            + .checkbox__background {
              color: var(--checkbox-border-checked);

                &::before {
                    background-color: var(--checkbox-border-checked);
                }

                svg {
                    opacity: 1;
                }
            }
        }
    }

    &__background {
        position: relative;
        display: flex;
        align-items: center;
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        cursor: pointer;
        z-index: 0;
        color: var(--checkbox-border);

        svg {
            @include theme.transition(transform);

            width: 1em;
            margin: auto;
            fill: #fff;
            opacity: 0;
            z-index: 1;
        }

        &::before {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            box-sizing: border-box;
            display: inline-block;
            width: var(--checkbox-border-size);
            height: var(--checkbox-border-size);
            margin: auto;
            border: 2px solid currentColor;
            border-radius: $checkbox-border-radius;
            content: '';
        }
    }

    @include theme.disabled-styles();

    &--sm {
        --checkbox-font-size: #{map.get($checkbox-font-size, sm)};
        --checkbox-size: #{map.get($checkbox-size, sm)};
        --checkbox-border-size: #{map.get($checkbox-border-size, sm)};
    }

    &--lg {
        --checkbox-font-size: #{map.get($checkbox-font-size, lg)};
        --checkbox-size: #{map.get($checkbox-size, lg)};
        --checkbox-border-size: #{map.get($checkbox-border-size, lg)};
    }

    @each $key, $value in $checkbox-skins {
        &--#{$key} {
            --checkbox-border-checked: #{map.get($value, border-checked)};
        }
    }
}
