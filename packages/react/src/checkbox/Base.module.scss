@use 'sass:map';
@use '../theme' as theme;
@use './variables' as *;

@include theme.scope($checkbox-root) {
    --checkbox-color: #{theme.get-color(secondary, 300)};
    --checkbox-font-size: #{map.get($checkbox-font-size, md)};
    --checkbox-size: #{map.get($checkbox-size, md)};

    display: inline-block;
    position: relative;
    width: var(--checkbox-size);
    height: var(--checkbox-size);
    font-size: var(--checkbox-font-size);
    border-radius: $checkbox-border-radius;

    @include theme.focus-styles();
    @include theme.disabled-styles();

    &:hover,
    &:active,
    &:focus {
        #{$checkbox-root}__background {
            --checkbox-color: #{theme.get-color(secondary, 400)};
        }
    }

    &__control {
        position: absolute;
        width: 100%;
        height: 100%;
        opacity: 0;
        margin: 0;
        cursor: pointer;
        overflow: hidden;

        &:checked {
            + .checkbox__background {
                &::before {
                    background-color: currentColor;
                }

                svg {
                    opacity: 1;
                }
            }
        }
    }

    &__background {
        pointer-events: none;
        position: relative;
        display: flex;
        align-items: center;
        width: 100%;
        height: 100%;
        color: var(--checkbox-color);

        svg {
            @include theme.transition(transform);

            width: 1em;
            margin: auto;
            fill: #fff;
            opacity: 0;
            z-index: 1;
        }

        &::before {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            border: 2px solid currentColor;
            border-radius: $checkbox-border-radius;
            content: '';
        }
    }

    &--sm {
        --checkbox-font-size: #{map.get($checkbox-font-size, sm)};
        --checkbox-size: #{map.get($checkbox-size, sm)};
    }

    &--lg {
        --checkbox-font-size: #{map.get($checkbox-font-size, lg)};
        --checkbox-size: #{map.get($checkbox-size, lg)};
    }

    @each $key, $value in $checkbox-skins {
        &--#{$key} {
            #{$checkbox-root} {
                &__control {
                    &:checked {
                        + .checkbox__background {
                            --checkbox-color: #{theme.get-color($value, 500)};
                        }
                    }
                }
            }
        }
    }
}
